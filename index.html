<!DOCTYPE html>
<html>

<head>
  <title>Webchat</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.0.4/socket.io.js"></script>
  <!-- <script>
    const socket = io();
  </script> -->
</head>

<body>

  <ul id="mensagens"></ul>

  <form action=''>
    <input id="mensagemInput" autocomplete="off" /><button>Send</button>
  </form>

  <script>
    const socket = io();
    const form = document.querySelector('form');
    const inputMessage = document.querySelector('#mensagemInput');
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      console.log("Chama o evento mensagem");
      const { id } = socket;
      console.log(id);
      socket.emit('message', {
        chatMessage: inputMessage.value,
        nickname: id,
      })
      // socket.emit('mensagem', inputMessage.value);
      inputMessage.value = '';
      return false;
    });

    const createMessage = (message) => {
      const messageUl = document.querySelector('#mensagens');
      const li = document.createElement('li');
      li.innerText = message;
      messageUl.appendChild(li);
    }

    socket.on('message', (message) =>  createMessage(message));

    // socket.on('serverMessage', ({ message }) => createMessage(message));

  </script>

</body>

</html>
